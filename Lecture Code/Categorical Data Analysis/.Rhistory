install.packages("DescTools")
# Loading packages
library(tidyverse)
library(AmesHousing)
library(gmodels)
library(ggplot2)
library(vcdExtra)
library(DescTools)
# loading data
ames <- make_ordinal_ames()
# Traing-Test Split in R
set.seed(123)
ames <- ames %>% mutate(id = row_number())
train <- ames %>% sample_frac(0.7)
test <- anti_join(ames, train, by = 'id')
train <- train %>%
mutate(Bonus = ifelse(Sale_Price > 175000, 1, 0))
# Exploring the data
table(train$Central_Air)
ggplot(data = train) +
geom_bar(mapping =
aes(x = Central_Air))
table(train$Bonus)
ggplot(data = train) +
geom_bar(mapping =
aes(x = Bonus))
# Cross-Tabulation Table (rows, columns)
table(train$Central_Air, train$Bonus)
ggplot(data = train) +
geom_bar(mapping =
aes(x = Bonus,
fill = Central_Air))
CrossTable(train$Central_Air, train$Bonus)
# Pearson Chi-Square Test - input is a table of variables
chisq.test(table(train$Central_Air, train$Bonus))
# Fisher's exact test
fisher.test(table(train$Central_Air, train$Bonus))
# Mantel-Haenszel Test - Ordinal Variables
CMHtest(table(train$Central_Air, train$Bonus))$table[1,]
# Odds Ratio
OddsRatio(table(train$Central_Air, train$Bonus))
# Cramer's V
assocstats(table(train$Central_Air, train$Bonus))
# Spearman's correlation
cor.test(x = as.numeric(ordered(train$Central_Air)),
y = as.numeric(ordered(train$Bonus)),
method = "spearman")
safety <- read.csv('https://raw.githubusercontent.com/IAAFaculty/statistical_foundations/master/safety.csv')
knitr::opts_chunk$set(echo = TRUE)
safety <- read.csv('https://raw.githubusercontent.com/IAA-Faculty/statistical_foundations/master/safety.csv')
View(safety)
knitr::opts_chunk$set(echo = TRUE)
safety <- read.csv('https://raw.githubusercontent.com/IAA-Faculty/statistical_foundations/master/safety.csv')
# Loading packages
library(tidyverse)
library(gmodels)
CrossTable(safety$Region[Region == "Asia"], safety$Unsafe)
CrossTable(safety$Region[safety$Region == "Asia"], safety$Unsafe)
CrossTable(safety$Region[safety$Region == "Asia"], safety$Unsafe)
CrossTable(safety$Region, safety$Unsafe)
35*.312
35*0.688
61*.688
15*.312
3/4
.312*15
?fisher.test
knitr::opts_chunk$set(echo = TRUE)
safety <- read.csv('https://raw.githubusercontent.com/IAA-Faculty/statistical_foundations/master/safety.csv')
# Loading packages
library(tidyverse)
fisher.test(table(safety$Region, safety$Unsafe))
knitr::opts_chunk$set(echo = TRUE)
safety <- read.csv('https://raw.githubusercontent.com/IAA-Faculty/statistical_foundations/master/safety.csv')
# Loading packages
library(tidyverse)
library(DescTools)
OddsRatio(table(safety$Region, safety$Unsafe))
knitr::opts_chunk$set(echo = TRUE)
safety <- read.csv('https://raw.githubusercontent.com/IAA-Faculty/statistical_foundations/master/safety.csv')
# Loading packages
library(tidyverse)
library(DescTools)
library(gmodels)
CrossTable(safety$Size, safety$Unsafe)
0.312 * 35
0.312 * 29
0.312 * 32
0.688 * 32
0.688 * 29
0.688*35
library(vcdExtra)
CMHtest(table(safety$Size, safety$Unsafe))
CMHtest(table(safety$Size, safety$Unsafe))$table[1,]
1.409484e-07
cor.test(x = as.numeric(ordered(safety$Size)),
y = as.numeric(ordered(safety$Unsafe)),
method = "spearman")
cor.test(x = as.numeric(ordered(safety$Size)),
y = as.numeric(ordered(safety$Unsafe)),
method = "spearman")
assocstats(table(safety$Size, safety$Unsafe))
CrossTable(safety$Region, safety$Unsafe)
CrossTable(safety$Size, safety$Unsafe)
CMHtest(table(safety$Size, safety$Unsafe))$table[1,]
